{% extends "base.html" %}

{% block title %}Monitoring{% endblock %}

{% block content %}
    <h5 class="mt-3">Sélectionner un container :</h5>
    <form method="POST" action="{{ url_for('monitoring') }}" class="mb-4">
        <div class="input-group">
            <select name="container_name" class="form-control">
                {% for container in containers %}
                    <option value="{{ container }}">{{ container }}</option>
                {% endfor %}
            </select>
            <button type="submit" class="btn btn-primary">Afficher les stats</button>
        </div>
    </form>

    {% if stats %}
    <div class="row">
        <!-- Carte Mémoire -->
        <div class="col-md-4">
            <div class="card text-white bg-info mb-3">
                <div class="card-header">
                    <i class="fas fa-memory"></i> Mémoire
                </div>
                <div class="card-body">
                    <h5 class="card-title">Utilisation de la mémoire</h5>
                    <p class="card-text">Actuelle : {{ stats.memory.usage }} Mo</p>
                    <p class="card-text">Maximale : {{ stats.memory.usage_peak }} Mo</p>
                </div>
            </div>
        </div>

        <!-- Carte Réseau eth0 -->
        <div class="col-md-4">
            <div class="card text-white bg-success mb-3">
                <div class="card-header">
                    <i class="fas fa-network-wired"></i> Réseau eth0
                </div>
                <div class="card-body">
                    <h5 class="card-title">Statistiques réseau</h5>
                    <p class="card-text">IP : {{ stats.network.eth0.ip }}</p>
                    <p class="card-text">Reçus : {{ stats.network.eth0.bytes_received }} bytes</p>
                    <p class="card-text">Envoyés : {{ stats.network.eth0.bytes_sent }} bytes</p>
                </div>
            </div>
        </div>

        <!-- Carte CPU -->
        <div class="col-md-4">
            <div class="card text-white bg-warning mb-3">
                <div class="card-header">
                    <i class="fas fa-microchip"></i> CPU
                </div>
                <div class="card-body">
                    <h5 class="card-title">Utilisation du CPU</h5>
                    <p class="card-text">Utilisation : {{ stats.cpu.usage_percentage }}%</p>
                    <p class="card-text">Temps : {{ stats.cpu.cpu_time_seconds }} secondes</p>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Carte Réseau loopback -->
        <div class="col-md-4">
            <div class="card text-white bg-secondary mb-3">
                <div class="card-header">
                    <i class="fas fa-sync"></i> Réseau Loopback
                </div>
                <div class="card-body">
                    <h5 class="card-title">Statistiques réseau</h5>
                    <p class="card-text">IP : {{ stats.network.lo.ip }}</p>
                    <p class="card-text">Reçus : {{ stats.network.lo.bytes_received }} bytes</p>
                    <p class="card-text">Envoyés : {{ stats.network.lo.bytes_sent }} bytes</p>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
{% endblock %}
